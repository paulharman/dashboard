(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{580:function(t,e,n){"use strict";n.r(e),n.d(e,"default",function(){return j});var s=n(0),i=n.n(s),a=n(37),r=n(22),o=n.n(r),u=n(13),l=n(11),h=n(57),c=n.n(h),p=n(50),f=n(296),b=n.n(f);function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function g(t,e,n){return e&&m(t.prototype,e),n&&m(t,n),t}function k(t,e){return!e||"object"!==d(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function S(t){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function E(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}function O(t,e){return(O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var j=function(t){function e(){var t;return y(this,e),(t=k(this,S(e).call(this))).state={hidden:!1},t}return E(e,i.a.Component),g(e,[{key:"isGuid",value:function(t){if(null==t)return!1;"{"===t[0]&&(t=t.substring(1,t.length-1));return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}},{key:"componentWillMount",value:function(){this.isGuid(this.props.id)||(this.pubSubToken=o.a.subscribe(this.props.id,this.onIncomingEvent.bind(this)))}},{key:"onIncomingEvent",value:function(t,e){"removeElement"===e.type&&this.setState({hidden:!0})}},{key:"componentDidUpdate",value:function(){this.state.hidden&&null!=this.pubSubToken&&o.a.unsubscribe(this.pubSubToken)}},{key:"componentWillUnmount",value:function(){null!=this.pubSubToken&&o.a.unsubscribe(this.pubSubToken)}},{key:"render",value:function(){return this.state.hidden?null:i.a.createElement(w,this.props)}}]),e}(),w=function(t){function e(t){var n;return y(this,e),(n=k(this,S(e).call(this,t))).state={content:t.content,tag:t.tag,attributes:t.attributes,events:t.events,loading:!0,hasError:!1,errorMessage:""},n}return E(e,i.a.Component),g(e,[{key:"loadData",value:function(){Object(u.b)("/api/internal/component/element/"+this.props.id,function(t){t.error?this.setState({hasError:!0,errorMessage:t.error.message}):this.setState({content:t,loading:!1})}.bind(this))}},{key:"componentDidCatch",value:function(t,e){this.setState({hasError:!0,errorMessage:t.message})}},{key:"componentWillMount",value:function(){this.pubSubToken=o.a.subscribe(this.props.id,this.onIncomingEvent.bind(this)),this.props.hasCallback?this.loadData():this.props.js?b.a.getScript(Object(l.a)()+"/api/internal/javascript/"+this.props.js,function(){this.setState({loading:!1})}.bind(this)):this.setState({loading:!1})}},{key:"onTextboxChanged",value:function(t){var e=t.target.value;this.state.attributes.value=e,this.setState({attributes:this.state.attributes})}},{key:"onCheckboxChanged",value:function(t){var e=t.target.value;e=t.target.checked,this.state.attributes.checked=e,this.setState({attributes:this.state.attributes});for(var n=0;n<this.state.events.length;n++)if("onChange"===this.state.events[n].event){var s=this.state.events[n];o.a.publish("element-event",{type:"clientEvent",eventId:s.id,eventName:"onChange",eventData:e})}}},{key:"componentWillUnmount",value:function(){if(!this.props.preventUnregister){if(null!=this.state.events)for(var t=0;t<this.state.events.length;t++)o.a.publish("element-event",{type:"unregisterEvent",eventId:this.state.events[t].id});this.props.hasCallback&&o.a.publish("element-event",{type:"unregisterEvent",eventId:this.props.id})}o.a.unsubscribe(this.pubSubToken)}},{key:"onIncomingEvent",value:function(t,e){if("setState"===e.type)this.setState(e.state);else if("requestState"===e.type)Object(u.c)("/api/internal/component/element/sessionState/".concat(e.requestId),this.state);else if("removeElement"===e.type)this.setState({hidden:!0});else if("addElement"===e.type){var n=this.state.content;null==n&&(n=[]),n=n.concat(e.elements),this.setState({content:n})}else"clearElement"===e.type?this.setState({content:null}):"syncElement"===e.type&&this.loadData()}},{key:"onUserEvent",value:function(t,e){var n=null,s=null;if("select"===this.state.tag){if(s=new Array,this.refs.element.selectedOptions){for(var i in this.refs.element.selectedOptions)if(!isNaN(i)){var a=this.refs.element.selectedOptions[i].value;s.push(a)}}else s.push(this.refs.element.value);s=1===s.length?s[0]:JSON.stringify(s);for(var r=0;r<this.state.events.length;r++)"onChange"===this.state.events[r].event&&(t=this.state.events[r]);n="onChange"}else n=t.event,null!=(s=e.target.value)&&null!=s.checked&&(s=e.target.checked);this.state.attributes.value=s,this.setState(this.state),o.a.publish("element-event",{type:"clientEvent",eventId:t.id,eventName:n,eventData:s})}},{key:"render",value:function(){if(this.state.hidden)return null;if(this.state.hasError)return i.a.createElement(p.default,{message:this.state.errorMessage});if(this.props.error)return i.a.createElement(p.default,{message:this.props.error.message});if(this.state.loading)return i.a.createElement("div",null);if(this.props.js)return Object(a.a)(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},s=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),s.forEach(function(e){v(t,e,n[e])})}return t}({type:this.props.componentName},this.props.props),this.props.history);var t=null;this.state.content&&this.state.content.map?t=this.state.content.map(function(t){return null!=t.type?Object(a.a)(t,this.props.history):t}.bind(this)):this.state.content&&(t=this.state.content);var e=this.state.attributes;return null==e&&(e={}),null==e.id&&(e.id=this.props.id),null!=this.state.events&&this.state.events.map&&this.state.events.map(function(t){return e[t.event]=function(e){this.onUserEvent(t,e)}.bind(this),null}.bind(this)),"input"===this.state.tag&&("text"!==e.type&&"password"!==e.type||(e.onChange=this.onTextboxChanged.bind(this)),"checkbox"===e.type&&(e.onChange=this.onCheckboxChanged.bind(this))),"textarea"===this.state.tag&&(e.onChange=this.onTextboxChanged.bind(this)),e.ref="element",e.key=this.props.key,this.element=i.a.createElement(this.state.tag,e,t),[this.element,i.a.createElement(c.a,{timeout:1e3*this.props.refreshInterval,enabled:this.props.autoRefresh,callback:this.loadData.bind(this)})]}}]),e}()}}]);
//# sourceMappingURL=ud-element.189099de3849a15af466.bundle.map